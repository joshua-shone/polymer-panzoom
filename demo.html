<!doctype html>
<html>

  <head>

    <meta charset="utf-8">
    
    <title>Panzoom Demo</title>
    
    <meta name="viewport" content="width=device-width, user-scalable=no">
    
    <script src="bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>
    
    <link rel="import" href="panzoom.html">
    
    <style>
      yb-panzoom {
        display: block;
        position: fixed;
        left:   50%;
        top:    50%;
        width:  300px;
        height: 300px;
        margin-left: -150px;
        margin-top:  -150px;
        background-color: #ddd;
      }
      yb-panzoom img {
        display: block;
        width:  300px;
        height: 300px;
      }
    </style>
    
  </head>
  
  <body>
    <yb-panzoom id="panzoom">
      <img src="demo-image.svg">
    </yb-panzoom>
  </body>
  
  <script>
    document.addEventListener('WebComponentsReady', function() {
    
      var panzoomElement = document.getElementById('panzoom');
      
      // Mouse-wheel zooming
      panzoomElement.addEventListener('wheel', function(event) {
        var zoomSpeed = 0.08;
        var zoomOffset = (event.deltaY < 0) ? zoomSpeed : -zoomSpeed;
        panzoomElement.panzoomTowardPosition(
          {
            x: event.pageX - panzoomElement.offsetLeft,
            y: event.pageY - panzoomElement.offsetTop,
          },
          zoomOffset
        );
      });
      
      // Mouse-drag panning
      panzoomElement.addEventListener('mousedown', function(event) {
        if (event.button === 0) {
          event.preventDefault();
          var lastCursorPosition = {x: event.pageX, y: event.pageY};
          function mousemove(event) {
            panzoomElement.panOffset({
              x: (event.pageX - lastCursorPosition.x) / panzoomElement.panzoomScale,
              y: (event.pageY - lastCursorPosition.y) / panzoomElement.panzoomScale,
            });
            lastCursorPosition = {x: event.pageX, y: event.pageY};
          }
          function mouseup(event) {
            window.removeEventListener('mousemove', mousemove);
            window.removeEventListener('mouseup',   mouseup);
          }
          
          window.addEventListener('mousemove', mousemove);
          window.addEventListener('mouseup',   mouseup);
          return false;
        }
      });
      
      // Keyboard controls
      document.addEventListener('keydown', function(event) {
        if (event.which === 39) {
          panzoomElement.panOffset({x: -10, y: 0});
        } else if (event.which === 38) {
          panzoomElement.panOffset({x: 0, y: 10});
        } else if (event.which === 40) {
          panzoomElement.panOffset({x: 0, y: -10});
        } else if (event.which === 37) {
          panzoomElement.panOffset({x: 10, y: 0});
        } else if (event.which === 107 || event.which === 109) {
          panzoomElement.panzoomTowardPosition(
            {
              x: (window.innerWidth  / 2) - panzoomElement.offsetLeft,
              y: (window.innerHeight / 2) - panzoomElement.offsetTop,
            },
            (event.which === 107) ? 0.08 : -0.08
          );
        }
      });
      
    });
  </script>

</html>